Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();exports.























































































createBackButtonManager=createBackButtonManager;exports.






getBackButtonManager=getBackButtonManager;var _reactNative=require('react-native');var _ExNavigationActions=require('./ExNavigationActions');var _ExNavigationActions2=_interopRequireDefault(_ExNavigationActions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var ExNavigationBackButtonManager=function(){function ExNavigationBackButtonManager(){var _this=this;_classCallCheck(this,ExNavigationBackButtonManager);this._listeners=[];this._onHardwareBackPress=function _callee(){var moreRoutes;return regeneratorRuntime.async(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(_this._store){_context.next=2;break;}return _context.abrupt('return');case 2:_context.next=4;return regeneratorRuntime.awrap(_this._store.dispatch(_ExNavigationActions2.default.goBack()));case 4:moreRoutes=_context.sent;if(moreRoutes===false){_reactNative.BackAndroid.exitApp();}case 6:case'end':return _context.stop();}}},null,_this);};this._disabledBackButtonPress=function(){return true;};this._listeners=[];}_createClass(ExNavigationBackButtonManager,[{key:'setStore',value:function setStore(store){this._store=store;}},{key:'unsetStore',value:function unsetStore(store){if(this._store===store){this._store=null;}}},{key:'pushListener',value:function pushListener(listener){var newListeners=[].concat(_toConsumableArray(this._listeners));newListeners.push(listener);this._setListeners(newListeners);}},{key:'popListener',value:function popListener(){var newListeners=[].concat(_toConsumableArray(this._listeners));newListeners.pop();this._setListeners(newListeners);}},{key:'ensureGlobalListener',value:function ensureGlobalListener(){this._setListeners([this._onHardwareBackPress]);}},{key:'disable',value:function disable(){this._listeners.forEach(function(listener){return _reactNative.BackAndroid.removeEventListener('hardwareBackPress',listener);});_reactNative.BackAndroid.addEventListener('hardwareBackPress',this._disabledBackButtonPress);}},{key:'enable',value:function enable(){this._setListeners([].concat(_toConsumableArray(this._listeners)));}},{key:'_setListeners',value:function _setListeners(newListeners){this.disable();this._listeners=newListeners;_reactNative.BackAndroid.removeEventListener('hardwareBackPress',this._disabledBackButtonPress);_reactNative.BackAndroid.addEventListener('hardwareBackPress',this._listeners[this._listeners.length-1]);}}]);return ExNavigationBackButtonManager;}();var manager=void 0;function createBackButtonManager(){if(!manager){manager=new ExNavigationBackButtonManager();}return manager;}function getBackButtonManager(){
return manager;
}